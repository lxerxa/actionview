webpackJsonp([29],{203:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},u=n(2),s=r(u),c=n(3),d=n(4),p=r(d),f=n(205).mermaidAPI,y=function(e){function t(e){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),f.initialize({startOnLoad:!1})}return a(t,e),l(t,[{key:"componentDidMount",value:function(){for(var e=this.props,t=e.collection,n=e.state,r=t.length,o="graph LR;S(( ))-->"+(t.length>0?t[0].id+'["'+t[0].name+'"]':"-")+";",a=function(e){var n=p.default.escape(t[e].name);return t[e].actions&&t[e].actions.length<=0?(o+=t[e].id+'["'+n+'"];',"continue"):void p.default.map(t[e].actions,function(r){p.default.map(r.results,function(a){o+=t[e].id+'["'+n+'"]',o+='--"'+p.default.escape(r.name)+"("+r.id+')"-->';var l=p.default.find(t,{id:a.step});o+=l.id+'["'+p.default.escape(l.name)+'"];'})})},l=0;l<r;l++){a(l)}if(n){var i=p.default.find(t,{state:n});i&&(o+=" style "+i.id+" fill:#ffffbd;")}f.render("div",o,null,document.getElementById("chart"))}},{key:"render",value:function(){var e=this.props,t=e.name,n=(e.collection,e.close);return s.default.createElement(c.Modal,{show:!0,onHide:n,backdrop:"static",bsSize:"large","aria-labelledby":"contained-modal-title-sm"},s.default.createElement(c.Modal.Header,{closeButton:!0,style:{background:"#f0f0f0",height:"50px"}},s.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},"工作流预览",t?" - "+t:"")),s.default.createElement(c.Modal.Body,{style:{maxHeight:"580px",overflow:"auto"}},s.default.createElement("div",{className:"mermaid",id:"chart"})),s.default.createElement(c.Modal.Footer,null,s.default.createElement("span",{style:{"float":"left",marginTop:"7px"}},"提示：预览不支持IE"),s.default.createElement(c.Button,{onClick:n},"关闭")))}}],[{key:"propTypes",value:{name:u.PropTypes.string,state:u.PropTypes.string,collection:u.PropTypes.array.isRequired,close:u.PropTypes.func.isRequired},enumerable:!0}]),t}(u.Component);t.default=y,e.exports=t.default}).call(this)}finally{}},205:function(e,t){e.exports=window.mermaid},249:function(e,t,n){try{(function(){"use strict";function e(e){return(0,c.asyncFuncCreator)({constant:"WORKFLOW_INDEX",promise:function(t){return t.request({url:"/project/"+e+"/workflow"})}})}function r(e,t){return(0,c.asyncFuncCreator)({constant:"WORKFLOW_CREATE",promise:function(n){return n.request({url:"/project/"+e+"/workflow",method:"post",data:t})}})}function o(e,t){return(0,c.asyncFuncCreator)({constant:"WORKFLOW_UPDATE",promise:function(n){return n.request({url:"/project/"+e+"/workflow/"+t.id,method:"put",data:t})}})}function a(e){return{type:"WORKFLOW_SELECT",id:e}}function l(e){return{type:"WORKFLOW_DELETE_NOTIFY",id:e}}function i(e,t){return(0,c.asyncFuncCreator)({constant:"WORKFLOW_DELETE",id:t,promise:function(n){return n.request({url:"/project/"+e+"/workflow/"+t,method:"delete"})}})}function u(e,t){return(0,c.asyncFuncCreator)({constant:"WORKFLOW_PREVIEW",id:t,promise:function(n){return n.request({url:"/project/"+e+"/workflow/"+t+"/preview"})}})}function s(e,t){return(0,c.asyncFuncCreator)({constant:"WORKFLOW_VIEW_USED",id:t,promise:function(n){return n.request({url:"/project/"+e+"/workflow/"+t+"/used"})}})}Object.defineProperty(t,"__esModule",{value:!0}),t.index=e,t.create=r,t.update=o,t.select=a,t.delNotify=l,t.del=i,t.preview=u,t.viewUsed=s;var c=n(41)}).call(this)}finally{}},1971:function(e,t,n){try{(function(){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{actions:(0,y.bindActionCreators)(h,e)}}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},d=n(2),p=o(d),f=n(38),y=n(40),m=n(249),h=r(m),v=n(1980),b=n(1981),w=function(e){function t(e){a(this,n),c(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.pid=""}l(t,e),s(t,[{key:"goConfig",value:function(e){var t=this.props.location.pathname,n=void 0===t?"":t,r=n+"/"+e;this.context.router.push({pathname:r})}},{key:"index",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.props.actions.index(this.pid));case 2:return e.abrupt("return",this.props.workflow.ecode);case 3:case"end":return e.stop()}},null,this)}},{key:"create",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.create(this.pid,e));case 2:return t.abrupt("return",this.props.workflow.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"update",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.update(this.pid,e));case 2:return t.abrupt("return",this.props.workflow.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"del",value:function(e){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.props.actions,n.next=3,regeneratorRuntime.awrap(t.del(this.pid,e));case 3:return n.abrupt("return",this.props.workflow.ecode);case 4:case"end":return n.stop()}},null,this)}},{key:"preview",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.preview(this.pid,e));case 2:return t.abrupt("return",this.props.workflow.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"viewUsed",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.viewUsed(this.pid,e));case 2:return t.abrupt("return",this.props.workflow.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"componentWillMount",value:function(){var e=this.props.location.pathname,t=void 0===e?"":e;if(/^\/admin\/scheme/.test(t))this.pid="$_sys_$";else{var n=this.props.params.key;this.pid=n}}},{key:"render",value:function(){var e=this.props.location.pathname,t=void 0===e?"":e;return p.default.createElement("div",null,p.default.createElement(v,u({isSysConfig:/^\/admin\/scheme/.test(t),create:this.create.bind(this),goConfig:this.goConfig.bind(this),i18n:this.props.i18n},this.props.workflow)),p.default.createElement(b,u({pkey:this.pid,index:this.index.bind(this),create:this.create.bind(this),select:this.props.actions.select,update:this.update.bind(this),del:this.del.bind(this),preview:this.preview.bind(this),goConfig:this.goConfig.bind(this),delNotify:this.props.actions.delNotify,viewUsed:this.viewUsed.bind(this),i18n:this.props.i18n},this.props.workflow)))}}],[{key:"propTypes",value:{actions:d.PropTypes.object.isRequired,location:d.PropTypes.object.isRequired,params:d.PropTypes.object.isRequired,i18n:d.PropTypes.object.isRequired,workflow:d.PropTypes.object.isRequired},enumerable:!0},{key:"contextTypes",value:{router:d.PropTypes.object.isRequired},enumerable:!0}]);var n=t;return t=(0,f.connect)(function(e){var t=e.i18n,n=e.workflow;return{i18n:t,workflow:n}},i)(t)||t}(d.Component);t.default=w,e.exports=t.default}).call(this)}finally{}},1972:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},s=n(2),c=r(s),d=n(12),p=n(3),f=n(4),y=r(f),m=n(6),h=n(35),v=n(5),b=function(e){var t={};return e.name||(t.name="必填"),t},w=function(e){function t(e){o(this,n),u(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.state={ecode:0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}a(t,e),i(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.initializeForm,n=e.data,r=y.default.clone(n);y.default.extend(r,{name:"复制 - "+n.name}),t(r)}},{key:"handleSubmit",value:function(){var e,t,n,r,o;return regeneratorRuntime.async(function(a){for(;;)switch(a.prev=a.next){case 0:return e=this.props,t=e.values,n=e.copy,r=e.close,a.next=6,regeneratorRuntime.awrap(n(y.default.mapKeys(t,function(e,t){return"id"==t?"source_id":t})));case 6:o=a.sent,0===o?(this.setState({ecode:0}),r(),m.notify.show("复制完成。","success",2e3)):this.setState({ecode:o});case 8:case"end":return a.stop()}},null,this)}},{key:"handleEntry",value:function(){h("input[name=name]").select()}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,n=e.submitting;n||(this.setState({ecode:0}),t())}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,n=e.fields,r=n.id,o=n.name,a=n.description,i=e.handleSubmit,u=e.invalid,s=e.submitting,d=e.data;return c.default.createElement(p.Modal,{show:!0,onHide:this.handleCancel,onEntered:this.handleEntry,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},c.default.createElement(p.Modal.Header,{closeButton:!0,style:{background:"#f0f0f0",height:"50px"}},c.default.createElement(p.Modal.Title,{id:"contained-modal-title-la"},"复制工作流 - "+d.name)),c.default.createElement("form",{onSubmit:i(this.handleSubmit),onKeyDown:function(e){13==e.keyCode&&e.preventDefault()}},c.default.createElement(p.Modal.Body,null,c.default.createElement(p.FormControl,l({type:"hidden"},r)),c.default.createElement(p.FormGroup,{controlId:"formControlsText",validationState:o.touched&&o.error?"error":null},c.default.createElement(p.ControlLabel,null,c.default.createElement("span",{className:"txt-impt"},"*"),"新工作流名"),c.default.createElement(p.FormControl,l({disabled:s,type:"text"},o,{placeholder:"工作流名"})),o.touched&&o.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},o.error)),c.default.createElement(p.FormGroup,{controlId:"formControlsText"},c.default.createElement(p.ControlLabel,null,"描述"),c.default.createElement(p.FormControl,l({disabled:s,type:"text"},a,{placeholder:"描述内容"})))),c.default.createElement(p.Modal.Footer,null,c.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!s&&t[this.state.ecode]),c.default.createElement("img",{src:v,className:s?"loading":"hide"}),c.default.createElement(p.Button,{disabled:s||u,type:"submit"},"确定"),c.default.createElement(p.Button,{bsStyle:"link",disabled:s,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,optionValues:s.PropTypes.array,submitting:s.PropTypes.bool,invalid:s.PropTypes.bool,values:s.PropTypes.object,fields:s.PropTypes.object,handleSubmit:s.PropTypes.func.isRequired,close:s.PropTypes.func.isRequired,data:s.PropTypes.object.isRequired,initializeForm:s.PropTypes.func.isRequired,copy:s.PropTypes.func.isRequired},enumerable:!0}]);var n=t;return t=(0,d.reduxForm)({form:"workflow",fields:["id","name","description"],validate:b})(t)||t}(s.Component);t.default=w,e.exports=t.default}).call(this)}finally{}},1973:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},s=n(2),c=r(s),d=n(12),p=n(3),f=n(4),y=r(f),m=n(6),h=n(5),v=function(e){var t={};return e.name||(t.name="必填"),t},b=function(e){function t(e){o(this,n),u(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.state={ecode:0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}a(t,e),i(t,[{key:"handleSubmit",value:function(){var e,t,n,r,o,a,l,i,u;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return e=this.props,t=e.values,n=e.create,r=e.close,o={id:0,name:"initial_action",results:[{step:1,status:"Underway"}]},s.next=7,regeneratorRuntime.awrap(n(y.default.assign(t,{contents:{initial_action:o,steps:[{id:1,name:"开始",state:"Open",actions:[]}]}})));case 7:a=s.sent,0===a?(this.setState({ecode:0}),r(),m.notify.show("新建完成，请配置流程。","success",2e3),l=this.props,i=l.data,u=l.goConfig,y.default.isEmpty(i)||u(i.id)):this.setState({ecode:a});case 9:case"end":return s.stop()}},null,this)}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,n=e.submitting;n||(this.setState({ecode:0}),t())}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,n=e.fields,r=n.name,o=n.description,a=e.handleSubmit,i=e.invalid,u=e.submitting;return c.default.createElement(p.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},c.default.createElement(p.Modal.Header,{closeButton:!0,style:{background:"#f0f0f0",height:"50px"}},c.default.createElement(p.Modal.Title,{id:"contained-modal-title-la"},"新建工作流")),c.default.createElement("form",{onSubmit:a(this.handleSubmit),onKeyDown:function(e){13==e.keyCode&&e.preventDefault()}},c.default.createElement(p.Modal.Body,null,c.default.createElement(p.FormGroup,{controlId:"formControlsText",validationState:r.touched&&r.error?"error":null},c.default.createElement(p.ControlLabel,null,c.default.createElement("span",{className:"txt-impt"},"*"),"工作流名"),c.default.createElement(p.FormControl,l({disabled:u,type:"text"},r,{placeholder:"工作流名"})),r.touched&&r.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},r.error)),c.default.createElement(p.FormGroup,{controlId:"formControlsText"},c.default.createElement(p.ControlLabel,null,"描述"),c.default.createElement(p.FormControl,l({disabled:u,type:"text"},o,{placeholder:"描述内容"})))),c.default.createElement(p.Modal.Footer,null,c.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!u&&t[this.state.ecode]),c.default.createElement("img",{src:h,className:u?"loading":"hide"}),c.default.createElement(p.Button,{disabled:u||i,type:"submit"},"确定"),c.default.createElement(p.Button,{bsStyle:"link",disabled:u,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,optionValues:s.PropTypes.array,submitting:s.PropTypes.bool,invalid:s.PropTypes.bool,values:s.PropTypes.object,fields:s.PropTypes.object,handleSubmit:s.PropTypes.func.isRequired,data:s.PropTypes.object,close:s.PropTypes.func.isRequired,create:s.PropTypes.func.isRequired,goConfig:s.PropTypes.func.isRequired},enumerable:!0}]);var n=t;return t=(0,d.reduxForm)({form:"workflow",fields:["name","description"],validate:v})(t)||t}(s.Component);t.default=b,e.exports=t.default}).call(this)}finally{}},1976:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},u=n(2),s=r(u),c=n(3),d=n(6),p=function(e){function t(e){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.confirm=this.confirm.bind(this),this.cancel=this.cancel.bind(this)}return a(t,e),l(t,[{key:"confirm",value:function(){var e,t,n,r,o;return regeneratorRuntime.async(function(a){for(;;)switch(a.prev=a.next){case 0:return e=this.props,t=e.close,n=e.del,r=e.data,t(),a.next=7,regeneratorRuntime.awrap(n(r.id));case 7:o=a.sent,0===o?d.notify.show("删除完成。","success",2e3):d.notify.show("删除失败。","error",2e3);case 9:case"end":return a.stop()}},null,this)}},{key:"cancel",value:function(){var e=this.props.close;e()}},{key:"render",value:function(){var e=this.props.data;return s.default.createElement(c.Modal,{show:!0,onHide:this.cancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},s.default.createElement(c.Modal.Header,{closeButton:!0,style:{background:"#f0f0f0",height:"50px"}},s.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},"删除工作流 - ",e.name)),s.default.createElement(c.Modal.Body,null,"确认要删除此工作流？"),s.default.createElement(c.Modal.Footer,null,s.default.createElement(c.Button,{onClick:this.confirm},"确定"),s.default.createElement(c.Button,{bsStyle:"link",onClick:this.cancel},"取消")))}}],[{key:"propTypes",value:{close:u.PropTypes.func.isRequired,del:u.PropTypes.func.isRequired,data:u.PropTypes.object.isRequired},enumerable:!0}]),t}(u.Component);t.default=p,e.exports=t.default}).call(this)}finally{}},1978:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},s=n(2),c=r(s),d=n(12),p=n(3),f=n(6),y=n(5),m=function(e){var t={};return e.name||(t.name="必填"),t},h=function(e){function t(e){o(this,n),u(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.state={ecode:0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}a(t,e),i(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.initializeForm,n=e.data;t(n)}},{key:"handleSubmit",value:function(){var e,t,n,r,o;return regeneratorRuntime.async(function(a){for(;;)switch(a.prev=a.next){case 0:return e=this.props,t=e.values,n=e.update,r=e.close,a.next=6,regeneratorRuntime.awrap(n(t));case 6:o=a.sent,0===o?(this.setState({ecode:0}),r(),f.notify.show("更新完成。","success",2e3)):this.setState({ecode:o});case 8:case"end":return a.stop()}},null,this)}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,n=e.submitting;n||(this.setState({ecode:0}),t())}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,n=e.fields,r=n.id,o=n.name,a=n.description,i=e.dirty,u=e.handleSubmit,s=e.invalid,d=e.submitting,f=e.data;return c.default.createElement(p.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},c.default.createElement(p.Modal.Header,{closeButton:!0,style:{background:"#f0f0f0",height:"50px"}},c.default.createElement(p.Modal.Title,{id:"contained-modal-title-la"},"编辑工作流 - "+f.name)),c.default.createElement("form",{onSubmit:u(this.handleSubmit),onKeyDown:function(e){13==e.keyCode&&e.preventDefault()}},c.default.createElement(p.Modal.Body,null,c.default.createElement(p.FormGroup,{controlId:"formControlsText",validationState:o.touched&&o.error?"error":null},c.default.createElement(p.FormControl,l({type:"hidden"},r)),c.default.createElement(p.ControlLabel,null,c.default.createElement("span",{className:"txt-impt"},"*"),"工作流名"),c.default.createElement(p.FormControl,l({disabled:d,type:"text"},o,{placeholder:"工作流名"})),o.touched&&o.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},o.error)),c.default.createElement(p.FormGroup,{controlId:"formControlsText"},c.default.createElement(p.ControlLabel,null,"描述"),c.default.createElement(p.FormControl,l({disabled:d,type:"text"},a,{placeholder:"描述内容"})))),c.default.createElement(p.Modal.Footer,null,c.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!d&&t[this.state.ecode]),c.default.createElement("img",{src:y,className:d?"loading":"hide"}),c.default.createElement(p.Button,{disabled:!i||d||s,type:"submit"},"确定"),c.default.createElement(p.Button,{bsStyle:"link",disabled:d,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,optionValues:s.PropTypes.array,submitting:s.PropTypes.bool,invalid:s.PropTypes.bool,dirty:s.PropTypes.bool,values:s.PropTypes.object,fields:s.PropTypes.object,handleSubmit:s.PropTypes.func.isRequired,close:s.PropTypes.func.isRequired,data:s.PropTypes.object.isRequired,initializeForm:s.PropTypes.func.isRequired,update:s.PropTypes.func.isRequired},enumerable:!0}]);var n=t;return t=(0,d.reduxForm)({form:"workflow",fields:["id","name","description"],validate:m})(t)||t}(s.Component);t.default=h,e.exports=t.default}).call(this)}finally{}},1980:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},u=n(2),s=r(u),c=n(3),d=n(4),p=r(d),f=n(1973),y=(n(5),function(e){function t(e){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={createModalShow:!1},this.createModalClose=this.createModalClose.bind(this)}return a(t,e),l(t,[{key:"createModalClose",value:function(){this.setState({createModalShow:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.i18n,r=t.isSysConfig,o=t.create,a=t.goConfig,l=t.collection;return s.default.createElement("div",null,s.default.createElement("div",{style:{marginTop:"5px"}},s.default.createElement(c.Button,{className:"create-btn",onClick:function(){e.setState({createModalShow:!0})}},s.default.createElement("i",{className:"fa fa-plus"})," 新建工作流")),s.default.createElement("div",{className:"info-col"},s.default.createElement("div",{className:"info-icon"},s.default.createElement("i",{className:"fa fa-info-circle"})),s.default.createElement("div",{className:"info-content"},"只能删除没有关联到问题类型",r&&"（包括各项目自定义问题类型）","的工作流。")),this.state.createModalShow&&s.default.createElement(f,{show:!0,close:this.createModalClose,create:o,goConfig:a,data:l.length>0?p.default.last(l):{},i18n:n}))}}],[{key:"propTypes",value:{i18n:u.PropTypes.object.isRequired,collection:u.PropTypes.array.isRequired,isSysConfig:u.PropTypes.bool.isRequired,goConfig:u.PropTypes.func.isRequired,create:u.PropTypes.func.isRequired},enumerable:!0}]),t}(u.Component));t.default=y,e.exports=t.default}).call(this)}finally{}},1981:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},u=n(2),s=r(u),c=(n(37),n(51)),d=n(3),p=n(4),f=(r(p),n(1978)),y=n(1972),m=n(1976),h=n(1982),v=n(203),b=n(5),w=function(e){function t(e){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={editModalShow:!1,copyModalShow:!1,delNotifyShow:!1,viewUsedShow:!1,previewShow:!1,operateShow:!1,hoverRowId:""},this.editModalClose=this.editModalClose.bind(this),this.copyModalClose=this.copyModalClose.bind(this),this.delNotifyClose=this.delNotifyClose.bind(this),this.viewUsedClose=this.viewUsedClose.bind(this),this.previewModalClose=this.previewModalClose.bind(this)}return a(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this.props.index;e()}},{key:"editModalClose",value:function(){this.setState({editModalShow:!1})}},{key:"copyModalClose",value:function(){this.setState({copyModalShow:!1})}},{key:"delNotifyClose",value:function(){this.setState({delNotifyShow:!1})}},{key:"viewUsedClose",value:function(){this.setState({viewUsedShow:!1})}},{key:"previewModalClose",value:function(){this.setState({previewModalShow:!1})}},{key:"operateSelect",value:function(e){var t,n,r,o,a,l;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=this.state.hoverRowId,n=this.props,r=n.select,o=n.preview,a=n.goConfig,l=0,"3"!==e){i.next=10;break}a(t),i.next=22;break;case 10:if("5"!==e){i.next=17;break}return i.next=13,regeneratorRuntime.awrap(o(t));case 13:l=i.sent,0===l&&this.setState({previewModalShow:!0}),i.next=22;break;case 17:r(t),"1"===e&&this.setState({editModalShow:!0}),"2"===e&&this.setState({delNotifyShow:!0}),"4"===e&&this.setState({copyModalShow:!0}),"6"===e&&this.setState({viewUsedShow:!0});case 22:case"end":return i.stop()}},null,this)}},{key:"onRowMouseOver",value:function(e){e.id!==this.state.hoverRowId&&this.setState({operateShow:!0,hoverRowId:e.id})}},{key:"onMouseLeave",value:function(){this.setState({operateShow:!1,hoverRowId:""})}},{key:"render",value:function(){for(var e=this.props,t=e.i18n,n=e.pkey,r=e.collection,o=e.selectedItem,a=e.loading,l=e.indexLoading,i=e.itemLoading,u=e.itemSteps,p=e.usedProjects,w=e.viewUsed,g=e.del,E=e.update,O=e.create,P=this.state,T=P.operateShow,k=P.hoverRowId,C=s.default.createElement("span",null,s.default.createElement("i",{className:"fa fa-cog"})),j=[],_=r.length,S=0;S<_;S++){var M="$_sys_$"!==n&&"$_sys_$"===r[S].project_key;j.push({id:r[S].id,name:s.default.createElement("div",null,s.default.createElement("span",{className:"table-td-title"},r[S].name,M&&s.default.createElement("span",{style:{
fontWeight:"normal"}}," (全局)")),r[S].description&&s.default.createElement("span",{className:"table-td-desc"},r[S].description)),latest_modify:s.default.createElement("span",null,r[S].latest_modified_time,s.default.createElement("br",null),r[S].latest_modifier&&r[S].latest_modifier.name),step:r[S].steps,operation:s.default.createElement("div",null,T&&k===r[S].id&&!i&&s.default.createElement(d.DropdownButton,{pullRight:!0,bsStyle:"link",style:{textDecoration:"blink",color:"#000"},title:C,key:S,id:"dropdown-basic-"+S,onSelect:this.operateSelect.bind(this)},s.default.createElement(d.MenuItem,{eventKey:"5"},"预览"),!M&&s.default.createElement(d.MenuItem,{eventKey:"3"},"配置"),s.default.createElement(d.MenuItem,{eventKey:"4"},"复制"),!M&&s.default.createElement(d.MenuItem,{eventKey:"1"},"编辑"),"$_sys_$"===n&&s.default.createElement(d.MenuItem,{eventKey:"6"},"查看项目应用"),!M&&!r[S].is_used&&s.default.createElement(d.MenuItem,{eventKey:"2"},"删除")),s.default.createElement("img",{src:b,className:i&&o.id===r[S].id?"loading":"hide"}))})}var R={};return l?R.noDataText=s.default.createElement("div",null,s.default.createElement("img",{src:b,className:"loading"})):R.noDataText="暂无数据显示。",R.onRowMouseOver=this.onRowMouseOver.bind(this),s.default.createElement("div",{style:{marginBottom:"30px"}},s.default.createElement(c.BootstrapTable,{pullRight:!0,data:j,bordered:!1,hover:!0,options:R,trClassName:"tr-top"},s.default.createElement(c.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"ID"),s.default.createElement(c.TableHeaderColumn,{dataField:"name"},"名称"),s.default.createElement(c.TableHeaderColumn,{dataField:"latest_modify"},"最近配置修改"),s.default.createElement(c.TableHeaderColumn,{dataField:"step",width:"200"},"步骤"),s.default.createElement(c.TableHeaderColumn,{width:"60",dataField:"operation"})),this.state.editModalShow&&s.default.createElement(f,{show:!0,close:this.editModalClose,update:E,data:o,i18n:t}),this.state.copyModalShow&&s.default.createElement(y,{show:!0,close:this.copyModalClose,copy:O,data:o,i18n:t}),this.state.delNotifyShow&&s.default.createElement(m,{show:!0,close:this.delNotifyClose,data:o,del:g}),this.state.viewUsedShow&&s.default.createElement(h,{show:!0,close:this.viewUsedClose,view:w,loading:a,data:o,projects:p,i18n:t}),this.state.previewModalShow&&s.default.createElement(v,{show:!0,close:this.previewModalClose,collection:u,name:o.name}))}}],[{key:"propTypes",value:{i18n:u.PropTypes.object.isRequired,pkey:u.PropTypes.string.isRequired,collection:u.PropTypes.array.isRequired,itemSteps:u.PropTypes.array.isRequired,selectedItem:u.PropTypes.object.isRequired,loading:u.PropTypes.bool.isRequired,itemLoading:u.PropTypes.bool.isRequired,indexLoading:u.PropTypes.bool.isRequired,index:u.PropTypes.func.isRequired,select:u.PropTypes.func.isRequired,update:u.PropTypes.func.isRequired,create:u.PropTypes.func.isRequired,del:u.PropTypes.func.isRequired,viewUsed:u.PropTypes.func.isRequired,usedProjects:u.PropTypes.array.isRequired,preview:u.PropTypes.func.isRequired,goConfig:u.PropTypes.func.isRequired},enumerable:!0}]),t}(u.Component);t.default=w,e.exports=t.default}).call(this)}finally{}},1982:function(e,t,n){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t,n){for(var r=!0;r;){var o=e,a=t,l=n;r=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var u=i.get;if(void 0===u)return;return u.call(l)}var s=Object.getPrototypeOf(o);if(null===s)return;e=s,t=a,n=l,r=!0,i=s=void 0}},u=n(2),s=r(u),c=n(3),d=n(37),p=n(4),f=r(p),y=n(5),m=function(e){function t(e){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleCancel=this.handleCancel.bind(this)}return a(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.view,n=e.data;t(n.id)}},{key:"handleCancel",value:function(){var e=this.props.close;e()}},{key:"render",value:function(){var e=this.props,t=e.projects,n=e.data,r=e.loading;return s.default.createElement(c.Modal,{show:!0,bsSize:"large",onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},s.default.createElement(c.Modal.Header,{closeButton:!0,style:{background:"#f0f0f0",height:"50px"}},s.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},"查看项目应用 - "+n.name)),s.default.createElement(c.Modal.Body,{style:{height:"420px",overflow:"auto"}},r&&s.default.createElement("div",{style:{marginTop:"150px",textAlign:"center"}},s.default.createElement("img",{src:y,className:"loading"})),!r&&s.default.createElement("div",{style:{marginBottom:"10px"}},t.length>0?s.default.createElement("span",null,"共有应用项目 ",s.default.createElement("strong",null,t.length)," 个"):s.default.createElement("span",null,"暂无项目应用")),!r&&t.length>0&&s.default.createElement(c.Table,{condensed:!0,hover:!0,responsive:!0},s.default.createElement("thead",null,s.default.createElement("tr",null,s.default.createElement("th",null,"项目名称"),s.default.createElement("th",null,"问题类型"))),s.default.createElement("tbody",null,f.default.map(t,function(e,t){return s.default.createElement("tr",{key:t},s.default.createElement("td",null,"active"===e.status?s.default.createElement("span",null,s.default.createElement(d.Link,{to:"/project/"+e.key},e.name)):s.default.createElement("span",null,e.name,"(已关闭)")),s.default.createElement("td",null,"active"===e.status?s.default.createElement("span",null,s.default.createElement("ul",{style:{marginBottom:"0px",paddingLeft:"0px",listStyle:"none"}},f.default.isEmpty(e.types)?"-":f.default.map(e.types,function(t,n){return s.default.createElement("li",{key:n},s.default.createElement(d.Link,{to:"/project/"+e.key+"/type"},t.name))}))):s.default.createElement("span",null,s.default.createElement("ul",{style:{marginBottom:"0px",paddingLeft:"0px",listStyle:"none"}},f.default.isEmpty(e.types)?"-":f.default.map(e.types,function(e,t){return s.default.createElement("li",{key:t},e.name)})))))})))),s.default.createElement(c.Modal.Footer,null,s.default.createElement(c.Button,{onClick:this.handleCancel},"关闭")))}}],[{key:"propTypes",value:{close:u.PropTypes.func.isRequired,view:u.PropTypes.func.isRequired,loading:u.PropTypes.bool.isRequired,data:u.PropTypes.object.isRequired,projects:u.PropTypes.array.isRequired},enumerable:!0}]),t}(u.Component);t.default=m,e.exports=t.default}).call(this)}finally{}}});
//# sourceMappingURL=workflow-ec660c173da20641fffe.js.map