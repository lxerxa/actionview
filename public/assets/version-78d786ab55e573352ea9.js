webpackJsonp([13],{30:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},s=r(1),u=n(s),c=r(15),d=function(e){function t(e){a(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={visible:!1},this.timer=null,this.scrollToTop=this.scrollToTop.bind(this)}return o(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.visibilityHeight,r=void 0===t?400:t,n=c(".doc-container");n.unbind("scroll").scroll(function(){var t=n.scrollTop();e.setState({visible:t>r})})}},{key:"componentWillUnmount",value:function(){c(".doc-container").unbind("scroll")}},{key:"scrollToTop",value:function(){var e=this,t=c(".doc-container"),r=50*(parseInt(t.scrollTop()/1e3)+1);cancelAnimationFrame(this.timer),this.timer=requestAnimationFrame(function n(){var a=t.scrollTop();a>0?(t.scrollTop(a-r>0?a-r:0),e.timer=requestAnimationFrame(n)):cancelAnimationFrame(e.timer)})}},{key:"render",value:function(){var e=this.state.visible,t=void 0!==e&&e;return u.default.createElement("div",{id:"backtop",className:"back-top",style:{visibility:t&&"visible"||"hidden"},onClick:this.scrollToTop},u.default.createElement("div",{className:"back-top-content"},u.default.createElement("div",{className:"back-top-icon"})))}}],[{key:"propTypes",value:{visibilityHeight:s.PropTypes.number},enumerable:!0}]),t}(s.Component);t.default=d,e.exports=t.default}).call(this)}finally{}},87:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},u=r(1),c=n(u),d=(r(2),r(21),r(3)),p=n(d),f=function(e){function t(e){a(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return o(t,e),i(t,[{key:"goPage",value:function(e){var t=this.props,r=t.query,n=t.refresh;n(l({},r,{page:e}))}},{key:"render",value:function(){var e=this,t=this.props,r=t.total,n=t.curPage,a=void 0===n?1:n,o=t.sizePerPage,l=t.paginationSize,i=void 0===l?4:l,s=p.default.ceil(r/o);(a>s||a<=0)&&(a=1);for(var u=[],d=0;d<i;d++){var f=a-i+d;f<=0||u.push(f)}u.push(a);for(var d=1;d<=i;d++){var f=p.default.add(a,d);if(f>s)break;u.push(f)}return c.default.createElement("div",{style:{marginTop:"10px",height:"45px"}},c.default.createElement("div",{className:"col-md-6",style:{textAlign:"left"}},c.default.createElement("span",null,p.default.add((a-1)*o,1),"-",a*o>=r?r:a*o," 共",r,"条 ",s,"页")),c.default.createElement("div",{className:"col-md-6",style:{textAlign:"right"}},s>1&&c.default.createElement("ul",{className:"pagination",style:{margin:"0px"}},a-i>1&&c.default.createElement("li",{key:"first"},c.default.createElement("span",{className:"page-button",onClick:this.goPage.bind(this,1),title:"首页"},"<<")),a-1>0&&s>1&&c.default.createElement("li",{key:"pre"},c.default.createElement("span",{className:"page-button",onClick:this.goPage.bind(this,a-1),title:"前页"},"<")),p.default.map(u,function(t,r){return c.default.createElement("li",{key:r,className:t===a?"active":""},c.default.createElement("span",{className:"page-button",onClick:e.goPage.bind(e,t)},t))}),a<s&&s>1&&c.default.createElement("li",{key:"next"},c.default.createElement("span",{className:"page-button",onClick:this.goPage.bind(this,p.default.add(a,1)),title:"后页"},">")),s-i>a&&c.default.createElement("li",{key:"last"},c.default.createElement("span",{className:"page-button",onClick:this.goPage.bind(this,s),title:"尾页"},">>")))))}}],[{key:"propTypes",value:{query:u.PropTypes.object,refresh:u.PropTypes.func,total:u.PropTypes.number.isRequired,curPage:u.PropTypes.number,sizePerPage:u.PropTypes.number,paginationSize:u.PropTypes.number},enumerable:!0}]),t}(u.Component);t.default=f,e.exports=t.default}).call(this)}finally{}},2026:function(e,t,r){try{(function(){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{actions:(0,m.bindActionCreators)(y,e)}}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},d=r(1),p=a(d),f=r(22),m=r(23),h=r(2095),y=n(h),v=r(3),b=a(v),g=r(60),E=r(2031),_=r(2032),w=function(e){function t(e){o(this,r),c(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e),this.pid=""}l(t,e),u(t,[{key:"refresh",value:function(e){var t="/project/"+this.pid+"/version";this.context.router.push({pathname:t,query:e})}},{key:"gotoIssueList",value:function(e){this.context.router.push({pathname:"/project/"+this.pid+"/issue",query:{resolve_version:e}})}},{key:"gotoGantt",value:function(e){this.context.router.push({pathname:"/project/"+this.pid+"/gantt",query:{resolve_version:e}})}},{key:"index",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return e=e||{},e.page||(e.page=1),t.next=4,regeneratorRuntime.awrap(this.props.actions.index(this.pid,g.stringify(e)));case 4:return t.abrupt("return",this.props.version.ecode);case 5:case"end":return t.stop()}},null,this)}},{key:"create",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.create(this.pid,e));case 2:return t.abrupt("return",this.props.version.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"update",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.update(this.pid,e));case 2:return t.abrupt("return",this.props.version.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"merge",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.merge(this.pid,e));case 2:return t.abrupt("return",this.props.version.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"release",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.props.actions.release(this.pid,e));case 2:return t.abrupt("return",this.props.version.ecode);case 3:case"end":return t.stop()}},null,this)}},{key:"del",value:function(e){var t;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return t=this.props.actions,r.next=3,regeneratorRuntime.awrap(t.del(this.pid,e));case 3:return r.abrupt("return",this.props.version.ecode);case 4:case"end":return r.stop()}},null,this)}},{key:"componentWillMount",value:function(){var e=this.props.params.key;this.pid=e}},{key:"render",value:function(){var e=this.props.location.query,t=void 0===e?{}:e;return this.props.project.options&&b.default.assign(this.props.version.options,this.props.project.options),p.default.createElement("div",null,p.default.createElement(E,s({create:this.create.bind(this),merge:this.merge.bind(this),i18n:this.props.i18n},this.props.version)),p.default.createElement(_,s({query:t,index:this.index.bind(this),refresh:this.refresh.bind(this),gotoIssueList:this.gotoIssueList.bind(this),gotoGantt:this.gotoGantt.bind(this),select:this.props.actions.select,release:this.release.bind(this),update:this.update.bind(this),del:this.del.bind(this),i18n:this.props.i18n},this.props.version)))}}],[{key:"contextTypes",value:{router:d.PropTypes.object.isRequired},enumerable:!0},{key:"propTypes",value:{location:d.PropTypes.object.isRequired,project:d.PropTypes.object.isRequired,actions:d.PropTypes.object.isRequired,params:d.PropTypes.object.isRequired,i18n:d.PropTypes.object.isRequired,version:d.PropTypes.object.isRequired},enumerable:!0}]);var r=t;return t=(0,f.connect)(function(e){var t=e.i18n,r=e.project,n=e.version;return{i18n:t,project:r,version:n}},i)(t)||t}(d.Component);t.default=w,e.exports=t.default}).call(this)}finally{}},2027:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},u=r(1),c=n(u),d=r(8),p=r(2),f=r(7),m=(n(f),r(3)),h=n(m),y=r(52),v=n(y),b=r(5),g=r(6),E=r(4),_=function(e,t){var r={};return e.name?h.default.findIndex(t.collection||[],{name:e.name})!==-1&&(r.name="该名称已存在"):r.name="必填",e.start_time&&(g(e.start_time).isValid()||(r.start_time="格式错误")),e.end_time&&(g(e.end_time).isValid()||(r.end_time="格式错误")),e.start_time&&e.end_time&&e.start_time>e.end_time&&(r.start_time="计划开始时间要早于计划完成时间"),r},w=function(e){function t(e){a(this,r),s(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e),this.state={ecode:0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}o(t,e),i(t,[{key:"handleSubmit",value:function(){var e,t,r,n,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.values,r=e.create,n=e.close,t.start_time&&(t.start_time=parseInt(g(t.start_time).startOf("day").format("X"))),t.end_time&&(t.end_time=parseInt(g(t.end_time).endOf("day").format("X"))),o.next=8,regeneratorRuntime.awrap(r(t));case 8:a=o.sent,0===a?(this.setState({ecode:0}),b.notify.show("新建完成。","success",2e3),n()):this.setState({ecode:a});case 10:case"end":return o.stop()}},null,this)}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,r=e.submitting;r||(this.setState({ecode:0}),t())}},{key:"componentWillMount",value:function(){var e=this.props.initializeForm;e({start_time:g(),end_time:g()})}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,r=e.fields,n=r.name,a=r.start_time,o=r.end_time,i=r.description,s=e.handleSubmit,u=e.invalid,d=e.submitting;return c.default.createElement(p.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},c.default.createElement(p.Modal.Header,{closeButton:!0},c.default.createElement(p.Modal.Title,{id:"contained-modal-title-la"},"创建版本")),c.default.createElement("form",{onSubmit:s(this.handleSubmit),onKeyUp:function(e){13==e.keyCode&&e.preventDefault()}},c.default.createElement(p.Modal.Body,null,c.default.createElement(p.FormGroup,{controlId:"formControlsText",validationState:n.touched&&n.error?"error":null},c.default.createElement(p.ControlLabel,null,c.default.createElement("span",{className:"txt-impt"},"*"),"名称"),c.default.createElement(p.FormControl,l({disabled:d,type:"text"},n,{placeholder:"版本名"})),n.touched&&n.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},n.error)),c.default.createElement("div",null,c.default.createElement(p.FormGroup,{style:{width:"45%",display:"inline-block"},validationState:a.value&&a.error?"error":null},c.default.createElement(p.ControlLabel,null,"计划开始时间"),c.default.createElement(v.default,{locale:"zh-cn",mode:"date",closeOnSelect:!0,dateFormat:"YYYY/MM/DD",timeFormat:!1,value:a.value,onChange:function(e){a.onChange(e)}}),a.value&&a.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},a.error)),c.default.createElement(p.FormGroup,{style:{width:"45%",display:"inline-block","float":"right"},validationState:o.value&&o.error?"error":null},c.default.createElement(p.ControlLabel,null,"计划完成时间"),c.default.createElement(v.default,{locale:"zh-cn",mode:"date",closeOnSelect:!0,dateFormat:"YYYY/MM/DD",timeFormat:!1,value:o.value,onChange:function(e){o.onChange(e)}}),o.value&&o.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},o.error))),c.default.createElement(p.FormGroup,null,c.default.createElement(p.ControlLabel,null,"描述"),c.default.createElement(p.FormControl,l({disabled:d,componentClass:"textarea",style:{height:"200px"}},i,{placeholder:"描述"})))),c.default.createElement(p.Modal.Footer,null,c.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!d&&t[this.state.ecode]),c.default.createElement("img",{src:E,className:d?"loading":"hide"}),c.default.createElement(p.Button,{disabled:d||u,type:"submit"},"确定"),c.default.createElement(p.Button,{bsStyle:"link",disabled:d,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:u.PropTypes.object.isRequired,submitting:u.PropTypes.bool,invalid:u.PropTypes.bool,values:u.PropTypes.object,fields:u.PropTypes.object,handleSubmit:u.PropTypes.func.isRequired,close:u.PropTypes.func.isRequired,initializeForm:u.PropTypes.func.isRequired,create:u.PropTypes.func.isRequired},enumerable:!0}]);var r=t;return t=(0,d.reduxForm)({form:"version",fields:["name","start_time","end_time","description"],validate:_})(t)||t}(u.Component);t.default=w,e.exports=t.default}).call(this)}finally{}},2028:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},s=r(1),u=n(s),c=r(2),d=r(7),p=n(d),f=r(5),m=r(3),h=n(m),y=r(4),v=function(e){function t(e){a(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={ecode:0,operate_flg:"0",swapVersion:""},this.confirm=this.confirm.bind(this),this.cancel=this.cancel.bind(this)}return o(t,e),l(t,[{key:"confirm",value:function(){var e,t,r,n,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.close,r=e.del,n=e.data,o.next=6,regeneratorRuntime.awrap(r(h.default.extend({},{id:n.id},{operate_flg:this.state.operate_flg,swap_version:this.state.swapVersion})));case 6:a=o.sent,0===a&&(t(),f.notify.show("删除完成。","success",2e3)),this.setState({ecode:a});case 9:case"end":return o.stop()}},null,this)}},{key:"cancel",value:function(){var e=this.props,t=e.close,r=e.loading;r||t()}},{key:"render",value:function(){var e=this,t=this.props,r=t.i18n.errMsg,n=t.data,a=t.versions,o=t.loading;return u.default.createElement(c.Modal,{show:!0,onHide:this.cancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},u.default.createElement(c.Modal.Header,{closeButton:!0},u.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},"删除版本 - ",n.name)),u.default.createElement(c.Modal.Body,null,n.is_used?u.default.createElement("div",{className:"info-col",style:{marginTop:"5px"}},u.default.createElement("div",{className:"info-icon"},u.default.createElement("i",{className:"fa fa-info-circle"})),u.default.createElement("div",{className:"info-content"},"有问题和此版本关联，请选择以下操作。")):u.default.createElement("div",{className:"info-col",style:{marginTop:"5px"}},u.default.createElement("div",{className:"info-icon"},u.default.createElement("i",{className:"fa fa-info-circle"})),u.default.createElement("div",{className:"info-content"},"没有问题和此版本关联，可放心删除。")),n.is_used&&u.default.createElement("div",{style:{margin:"20px 10px 10px 10px"}},u.default.createElement("div",{style:{display:"inline-block",verticalAlign:"top",fontWeight:600}},"修复问题"),u.default.createElement("div",{style:{display:"inline-block",marginLeft:"20px"}},u.default.createElement(c.FormGroup,null,u.default.createElement(c.Radio,{inline:!0,name:"swap",onClick:function(){e.setState({operate_flg:"1"})},checked:"1"===this.state.operate_flg},"移动至版本"),u.default.createElement("div",{style:{width:"300px",margin:"5px 5px 10px 18px"}},u.default.createElement(p.default,{simpleValue:!0,clearable:!1,disabled:"1"!==this.state.operate_flg,options:h.default.map(h.default.reject(a,{id:n.id}),function(e){return{value:e.id,label:e.name}}),value:this.state.swapVersion,onChange:function(t){e.setState({swapVersion:t})},placeholder:"选择版本"})),u.default.createElement(c.Radio,{inline:!0,name:"remove",onClick:function(){e.setState({operate_flg:"2"})},checked:"2"===this.state.operate_flg},"移除版本"))))),u.default.createElement(c.Modal.Footer,null,u.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!o&&r[this.state.ecode]),u.default.createElement("img",{src:y,className:o?"loading":"hide"}),u.default.createElement(c.Button,{onClick:this.confirm,disabled:o||n.is_used&&"0"===this.state.operate_flg||"1"===this.state.operate_flg&&!this.state.swapVersion},"确定"),u.default.createElement(c.Button,{bsStyle:"link",disabled:o,onClick:this.cancel},"取消")))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,close:s.PropTypes.func.isRequired,del:s.PropTypes.func.isRequired,versions:s.PropTypes.array.isRequired,loading:s.PropTypes.bool.isRequired,data:s.PropTypes.object.isRequired},enumerable:!0}]),t}(s.Component);t.default=v,e.exports=t.default}).call(this)}finally{}},2029:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},s=r(1),u=n(s),c=r(2),d=r(3),p=n(d),f=r(6),m=function(e){function t(e){a(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleCancel=this.handleCancel.bind(this)}return o(t,e),l(t,[{key:"handleCancel",value:function(){var e=this.props.close;e()}},{key:"render",value:function(){var e=this.props.data;return u.default.createElement(c.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},u.default.createElement(c.Modal.Header,{closeButton:!0},u.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},"版本详情")),u.default.createElement(c.Modal.Body,{style:{maxHeight:"580px",overflow:"auto"}},u.default.createElement(c.Form,{horizontal:!0},u.default.createElement(c.FormGroup,null,u.default.createElement(c.Col,{sm:3,componentClass:c.ControlLabel},"名称"),u.default.createElement(c.Col,{sm:9},u.default.createElement("div",{style:{marginTop:"7px"}},e.name||"-"))),u.default.createElement(c.FormGroup,null,u.default.createElement(c.Col,{sm:3,componentClass:c.ControlLabel},"计划开始时间"),u.default.createElement(c.Col,{sm:9},u.default.createElement("div",{style:{marginTop:"7px"}},e.start_time?f.unix(e.start_time).format("YYYY/MM/DD"):"-"))),u.default.createElement(c.FormGroup,null,u.default.createElement(c.Col,{sm:3,componentClass:c.ControlLabel},"计划完成时间"),u.default.createElement(c.Col,{sm:9},u.default.createElement("div",{style:{marginTop:"7px"}},e.end_time?f.unix(e.end_time).format("YYYY/MM/DD"):"-"))),u.default.createElement(c.FormGroup,null,u.default.createElement(c.Col,{sm:3,componentClass:c.ControlLabel},"发布时间"),u.default.createElement(c.Col,{sm:9},u.default.createElement("div",{style:{marginTop:"7px"}},e.released_time?f.unix(e.released_time).format("YYYY/MM/DD"):"-"))),u.default.createElement(c.FormGroup,null,u.default.createElement(c.Col,{sm:3,componentClass:c.ControlLabel},"状态"),u.default.createElement(c.Col,{sm:9},u.default.createElement("div",{style:{marginTop:"7px"}},"released"===e.status?"已发布":"未发布"))),u.default.createElement(c.FormGroup,null,u.default.createElement(c.Col,{sm:3,componentClass:c.ControlLabel}," 描述"),u.default.createElement(c.Col,{sm:9},u.default.createElement("div",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",marginTop:"7px"},dangerouslySetInnerHTML:{__html:p.default.escape(e.description||"-").replace(/(\r\n)|(\n)/g,"<br/>")}}))))),u.default.createElement(c.Modal.Footer,null,u.default.createElement(c.Button,{onClick:this.handleCancel},"关闭")))}}],[{key:"propTypes",value:{close:s.PropTypes.func.isRequired,data:s.PropTypes.object.isRequired},enumerable:!0}]),t}(s.Component);t.default=m,e.exports=t.default}).call(this)}finally{}},2030:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},u=r(1),c=n(u),d=r(8),p=r(2),f=r(3),m=n(f),h=r(52),y=n(h),v=r(5),b=r(6),g=r(4),E=function(e,t){var r={};return e.name?t.data.name!==e.name&&m.default.findIndex(t.collection||[],{name:e.name})!==-1&&(r.name="该名称已存在"):r.name="必填",e.start_time&&(b(e.start_time).isValid()||(r.start_time="格式错误")),e.end_time&&(b(e.end_time).isValid()||(r.end_time="格式错误")),e.start_time&&e.end_time&&e.start_time>e.end_time&&(r.start_time="计划开始时间要早于计划完成时间"),r},_=function(e){function t(e){a(this,r),s(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e),this.state={ecode:0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}o(t,e),i(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.initializeForm,r=e.data;t(l({},r,{start_time:r.start_time?b.unix(r.start_time):r.start_time,end_time:r.end_time?b.unix(r.end_time):r.end_time}))}},{key:"handleSubmit",value:function(){var e,t,r,n,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.values,r=e.edit,n=e.close,t.start_time&&(t.start_time=parseInt(b(t.start_time).startOf("day").format("X"))),t.end_time&&(t.end_time=parseInt(b(t.end_time).endOf("day").format("X"))),o.next=8,regeneratorRuntime.awrap(r(t));case 8:a=o.sent,0===a?(this.setState({ecode:0}),n(),v.notify.show("更新完成。","success",2e3)):this.setState({ecode:a});case 10:case"end":return o.stop()}},null,this)}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,r=e.submitting;r||(this.setState({ecode:0}),t())}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,r=e.fields,n=r.id,a=r.name,o=r.start_time,i=r.end_time,s=r.description,u=e.handleSubmit,d=e.invalid,f=e.dirty,m=e.submitting,h=e.data;return c.default.createElement(p.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},c.default.createElement(p.Modal.Header,{closeButton:!0},c.default.createElement(p.Modal.Title,{id:"contained-modal-title-la"},"编辑版本 - "+h.name)),c.default.createElement("form",{onSubmit:u(this.handleSubmit),onKeyUp:function(e){13==e.keyCode&&e.preventDefault()}},c.default.createElement(p.Modal.Body,null,c.default.createElement(p.FormGroup,{controlId:"formControlsText",validationState:a.touched&&a.error?"error":null},c.default.createElement(p.ControlLabel,null,c.default.createElement("span",{className:"txt-impt"},"*"),"名称"),c.default.createElement(p.FormControl,l({type:"hidden"},n)),c.default.createElement(p.FormControl,l({disabled:m,type:"text"},a,{placeholder:"版本名"})),a.touched&&a.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},a.error)),c.default.createElement("div",null,c.default.createElement(p.FormGroup,{style:{width:"45%",display:"inline-block"},validationState:o.value&&o.error?"error":null},c.default.createElement(p.ControlLabel,null,"计划开始时间"),c.default.createElement(y.default,{locale:"zh-cn",mode:"date",closeOnSelect:!0,dateFormat:"YYYY/MM/DD",timeFormat:!1,value:o.value,onChange:function(e){o.onChange(e)}}),o.value&&o.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},o.error)),c.default.createElement(p.FormGroup,{style:{width:"45%",display:"inline-block","float":"right"},validationState:i.value&&i.error?"error":null},c.default.createElement(p.ControlLabel,null,"计划完成时间"),c.default.createElement(y.default,{locale:"zh-cn",mode:"date",closeOnSelect:!0,dateFormat:"YYYY/MM/DD",timeFormat:!1,value:i.value,onChange:function(e){i.onChange(e)}}),i.value&&i.error&&c.default.createElement(p.HelpBlock,{style:{"float":"right"}},i.error))),c.default.createElement(p.FormGroup,null,c.default.createElement(p.ControlLabel,null,"描述"),c.default.createElement(p.FormControl,l({disabled:m,componentClass:"textarea",style:{height:"200px"}},s,{placeholder:"描述"})))),c.default.createElement(p.Modal.Footer,null,c.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!m&&t[this.state.ecode]),c.default.createElement("img",{src:g,className:m?"loading":"hide"}),c.default.createElement(p.Button,{disabled:!f||m||d,type:"submit"},"确定"),c.default.createElement(p.Button,{bsStyle:"link",disabled:m,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:u.PropTypes.object.isRequired,submitting:u.PropTypes.bool,invalid:u.PropTypes.bool,dirty:u.PropTypes.bool,values:u.PropTypes.object,fields:u.PropTypes.object,handleSubmit:u.PropTypes.func.isRequired,close:u.PropTypes.func.isRequired,data:u.PropTypes.object.isRequired,initializeForm:u.PropTypes.func.isRequired,edit:u.PropTypes.func.isRequired},enumerable:!0}]);var r=t;return t=(0,d.reduxForm)({form:"version",fields:["id","name","start_time","end_time","description"],validate:E})(t)||t}(u.Component);t.default=_,e.exports=t.default}).call(this)}finally{}},2031:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{
value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},s=r(1),u=n(s),c=r(2),d=r(2027),p=r(2033),f=(r(4),function(e){function t(e){a(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={createModalShow:!1,mergeModalShow:!1},this.createModalClose=this.createModalClose.bind(this),this.mergeModalClose=this.mergeModalClose.bind(this)}return o(t,e),l(t,[{key:"createModalClose",value:function(){this.setState({createModalShow:!1})}},{key:"mergeModalClose",value:function(){this.setState({mergeModalShow:!1})}},{key:"render",value:function(){var e=this,t=this.props,r=t.i18n,n=t.options,a=void 0===n?{}:n,o=t.create,l=t.merge,i=t.indexLoading,s=t.collection;return u.default.createElement("div",null,a.permissions&&a.permissions.indexOf("manage_project")!==-1?u.default.createElement("div",{style:{marginTop:"5px"}},u.default.createElement(c.Button,{className:"create-btn",disabled:i,onClick:function(){e.setState({createModalShow:!0})}},u.default.createElement("i",{className:"fa fa-plus"})," 新建版本"),u.default.createElement(c.Button,{className:"create-btn",disabled:i,onClick:function(){e.setState({mergeModalShow:!0})}},u.default.createElement("i",{className:"fa fa-code-fork"})," 合并版本")):u.default.createElement("div",{style:{marginTop:"15px"}}),this.state.createModalShow&&u.default.createElement(d,{show:!0,close:this.createModalClose,create:o,collection:s,i18n:r}),this.state.mergeModalShow&&u.default.createElement(p,{show:!0,close:this.mergeModalClose,merge:l,versions:s,i18n:r}))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,options:s.PropTypes.object.isRequired,create:s.PropTypes.func.isRequired,merge:s.PropTypes.func.isRequired,collection:s.PropTypes.array,indexLoading:s.PropTypes.bool.isRequired},enumerable:!0}]),t}(s.Component));t.default=f,e.exports=t.default}).call(this)}finally{}},2032:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},s=r(1),u=n(s),c=r(21),d=r(31),p=r(2),f=r(3),m=n(f),h=r(2029),y=r(2030),v=r(2034),b=r(2028),g=r(87),E=r(30),_=r(6),w=r(4),P=function(e){function t(e){a(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={viewModalShow:!1,editModalShow:!1,delNotifyShow:!1,operateShow:!1,hoverRowId:""},this.viewModalClose=this.viewModalClose.bind(this),this.editModalClose=this.editModalClose.bind(this),this.releaseModalClose=this.releaseModalClose.bind(this),this.delNotifyClose=this.delNotifyClose.bind(this)}return o(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.index,r=e.query;t(r)}},{key:"componentWillReceiveProps",value:function(e){var t=e.query||{},r=this.props,n=r.index,a=r.query;m.default.isEqual(t,a)||n(t)}},{key:"viewModalClose",value:function(){this.setState({viewModalShow:!1})}},{key:"editModalClose",value:function(){this.setState({editModalShow:!1})}},{key:"releaseModalClose",value:function(){this.setState({releaseModalShow:!1})}},{key:"delNotifyClose",value:function(){this.setState({delNotifyShow:!1})}},{key:"view",value:function(e){this.setState({viewModalShow:!0});var t=this.props.select;t(e)}},{key:"edit",value:function(e){this.setState({editModalShow:!0});var t=this.props.select;t(e)}},{key:"release",value:function(e){this.setState({releaseModalShow:!0});var t=this.props.select;t(e)}},{key:"delNotify",value:function(e){this.setState({delNotifyShow:!0});var t=this.props.select;t(e)}},{key:"operateSelect",value:function(e){var t=this.state.hoverRowId,r=this.props,n=r.gotoIssueList,a=r.gotoGantt;"view"===e?this.view(t):"edit"===e?this.edit(t):"del"===e?this.delNotify(t):"release"===e||"unrelease"===e?this.release(t):"issuelist"===e?n(t):"gantt"===e&&a(t)}},{key:"onRowMouseOver",value:function(e){e.id!==this.state.hoverRowId&&this.setState({operateShow:!0,hoverRowId:e.id})}},{key:"onMouseLeave",value:function(){this.setState({operateShow:!1,hoverRowId:""})}},{key:"render",value:function(){for(var e=this.props,t=e.i18n,r=e.query,n=e.refresh,a=e.options,o=void 0===a?{}:a,l=e.collection,i=e.selectedItem,s=e.indexLoading,f=e.itemLoading,m=e.loading,P=e.del,O=e.release,C=e.update,T=this.state,k=T.hoverRowId,j=T.operateShow,x=u.default.createElement("span",null,u.default.createElement("i",{className:"fa fa-cog"})),M=[],S=l.length,R=0;R<S;R++)M.push({id:l[R].id,name:u.default.createElement("div",null,u.default.createElement("span",{className:"table-td-title"},l[R].name)),start_time:u.default.createElement("div",{style:{display:"table",width:"100%"}},u.default.createElement("div",{style:{display:"inline-block","float":"left",margin:"3px",marginBottom:"6px"}},l[R].start_time?_.unix(l[R].start_time).format("YYYY/MM/DD"):"-")),end_time:u.default.createElement("div",{style:{display:"table",width:"100%"}},u.default.createElement("div",{style:{display:"inline-block","float":"left",margin:"3px",marginBottom:"6px",color:l[R].end_time&&o.current_time>l[R].end_time&&"released"!==l[R].status?"red":"#000"}},l[R].end_time?_.unix(l[R].end_time).format("YYYY/MM/DD"):"-")),released_time:u.default.createElement("div",{style:{display:"table",width:"100%"}},u.default.createElement("div",{style:{display:"inline-block","float":"left",margin:"3px",marginBottom:"6px"}},l[R].released_time?_.unix(l[R].released_time).format("YYYY/MM/DD"):"-")),issues:u.default.createElement("ul",{style:{marginBottom:"0px",paddingLeft:"0px",listStyle:"none"}},u.default.createElement("li",null,"所有问题 - ",u.default.createElement(c.Link,{to:"/project/"+l[R].project_key+"/issue?resolve_version="+l[R].id},l[R].all_cnt||0)),u.default.createElement("li",null,"未解决的 - ",u.default.createElement(c.Link,{to:"/project/"+l[R].project_key+"/issue?resolution=Unresolved&resolve_version="+l[R].id},u.default.createElement("span",{style:{color:"red"}},l[R].unresolved_cnt||0)))),status:u.default.createElement("span",null,"released"===l[R].status?u.default.createElement("span",{style:{color:"#009900"},title:"已发布"},u.default.createElement("i",{className:"fa fa-check"})):"未发布"),operation:o.permissions&&o.permissions.indexOf("manage_project")!==-1?u.default.createElement("div",null,j&&k===l[R].id&&!f&&u.default.createElement(p.DropdownButton,{pullRight:!0,bsStyle:"link",style:{textDecoration:"blink",color:"#000"},key:R,title:x,id:"dropdown-basic-"+R,onSelect:this.operateSelect.bind(this)},u.default.createElement(p.MenuItem,{eventKey:"view"},"查看"),u.default.createElement(p.MenuItem,{eventKey:"edit"},"编辑"),"released"!=l[R].status&&u.default.createElement(p.MenuItem,{eventKey:"release"},"发布"),u.default.createElement(p.MenuItem,{eventKey:"del"},"删除"),u.default.createElement(p.MenuItem,{divider:!0}),u.default.createElement(p.MenuItem,{eventKey:"issuelist"},"问题列表"),u.default.createElement(p.MenuItem,{eventKey:"gantt"},"甘特图")),u.default.createElement("img",{src:w,className:f&&i.id===l[R].id?"loading":"hide"})):u.default.createElement(p.Button,{bsStyle:"link",onClick:this.view.bind(this,l[R].id)},"查看")});var q={};return s?q.noDataText=u.default.createElement("div",null,u.default.createElement("img",{src:w,className:"loading"})):q.noDataText="暂无数据显示。",q.onRowMouseOver=this.onRowMouseOver.bind(this),u.default.createElement("div",{style:{marginBottom:"30px"}},u.default.createElement(E,null),u.default.createElement(d.BootstrapTable,{data:M,bordered:!1,hover:!0,options:q,trClassName:"tr-top"},u.default.createElement(d.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"ID"),u.default.createElement(d.TableHeaderColumn,{dataField:"name"},"名称"),u.default.createElement(d.TableHeaderColumn,{dataField:"start_time",width:"130"},"计划开始时间"),u.default.createElement(d.TableHeaderColumn,{dataField:"end_time",width:"130"},"计划完成时间"),u.default.createElement(d.TableHeaderColumn,{dataField:"issues",width:"150"},"问题完成情况"),u.default.createElement(d.TableHeaderColumn,{dataField:"status",width:"100"},"状态"),u.default.createElement(d.TableHeaderColumn,{width:"80",dataField:"operation"})),!s&&o.total&&o.total>0?u.default.createElement(g,{total:o.total||0,curPage:r.page?r.page-0:1,sizePerPage:o.sizePerPage||50,paginationSize:4,query:r,refresh:n}):"",this.state.viewModalShow&&u.default.createElement(h,{show:!0,close:this.viewModalClose,data:i}),this.state.editModalShow&&u.default.createElement(y,{show:!0,close:this.editModalClose,edit:C,data:i,collection:l,i18n:t}),this.state.delNotifyShow&&u.default.createElement(b,{show:!0,close:this.delNotifyClose,data:i,versions:l,del:P,i18n:t}),this.state.releaseModalShow&&u.default.createElement(v,{show:!0,loading:m,close:this.releaseModalClose,data:i,versions:l,release:O,i18n:t}))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,options:s.PropTypes.object.isRequired,collection:s.PropTypes.array.isRequired,selectedItem:s.PropTypes.object.isRequired,loading:s.PropTypes.bool.isRequired,itemLoading:s.PropTypes.bool.isRequired,indexLoading:s.PropTypes.bool.isRequired,index:s.PropTypes.func.isRequired,refresh:s.PropTypes.func.isRequired,gotoIssueList:s.PropTypes.func.isRequired,gotoGantt:s.PropTypes.func.isRequired,query:s.PropTypes.object,select:s.PropTypes.func.isRequired,update:s.PropTypes.func.isRequired,release:s.PropTypes.func.isRequired,del:s.PropTypes.func.isRequired},enumerable:!0}]),t}(s.Component);t.default=P,e.exports=t.default}).call(this)}finally{}},2033:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},s=r(1),u=n(s),c=r(8),d=r(2),p=r(7),f=n(p),m=r(3),h=n(m),y=r(5),v=r(4),b=function(e,t){var r={};return e.source||(r.source="必填"),e.dest||(r.dest="必填"),r},g=function(e){function t(e){a(this,r),i(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e),this.state={ecode:0,isSendMsg:!0},this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}o(t,e),l(t,[{key:"handleSubmit",value:function(){var e,t,r,n,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.merge,r=e.values,n=e.close,o.next=6,regeneratorRuntime.awrap(t({source:r.source,dest:r.dest}));case 6:a=o.sent,0===a?(this.setState({ecode:0}),n(),y.notify.show("已合并。","success",2e3)):this.setState({ecode:a});case 8:case"end":return o.stop()}},null,this)}},{key:"handleCancel",value:function(){var e=this.props,t=e.close,r=e.submitting;r||(this.setState({ecode:0}),t())}},{key:"render",value:function(){var e=this.props,t=e.i18n.errMsg,r=e.fields,n=r.source,a=r.dest,o=e.handleSubmit,l=e.invalid,i=e.submitting,s=e.versions,c=h.default.map(s||[],function(e){return{label:e.name,value:e.id}});return u.default.createElement(d.Modal,{show:!0,onHide:this.handleCancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},u.default.createElement(d.Modal.Header,{closeButton:!0},u.default.createElement(d.Modal.Title,{id:"contained-modal-title-la"},"合并版本")),u.default.createElement("form",{onSubmit:o(this.handleSubmit),onKeyDown:function(e){13==e.keyCode&&e.preventDefault()}},u.default.createElement(d.Modal.Body,null,u.default.createElement("div",{className:"info-col",style:{marginBottom:"15px",marginTop:"5px"}},u.default.createElement("div",{className:"info-icon"},u.default.createElement("i",{className:"fa fa-info-circle"})),u.default.createElement("div",{className:"info-content"},"版本合并后，将无法还原，请谨慎合并。")),u.default.createElement(d.FormGroup,{controlId:"formControlsText",validationState:n.touched&&n.error?"error":null},u.default.createElement(d.ControlLabel,null,u.default.createElement("span",{className:"txt-impt"},"*"),"要合并版本"),u.default.createElement(f.default,{simpleValue:!0,clearable:!1,disabled:i,options:c,value:n.value,onChange:function(e){n.onChange(e)},placeholder:"选择版本"}),n.touched&&n.error&&u.default.createElement(d.HelpBlock,{style:{"float":"right"}},n.error)),u.default.createElement(d.FormGroup,{controlId:"formControlsText",validationState:a.touched&&a.error?"error":null},u.default.createElement(d.ControlLabel,null,u.default.createElement("span",{className:"txt-impt"},"*"),"合并至"),u.default.createElement(f.default,{simpleValue:!0,clearable:!1,disabled:i,options:c,value:a.value,onChange:function(e){a.onChange(e)},placeholder:"选择版本"}),a.touched&&a.error&&u.default.createElement(d.HelpBlock,{style:{"float":"right"}},a.error))),u.default.createElement(d.Modal.Footer,null,u.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!i&&t[this.state.ecode]),u.default.createElement("img",{src:v,className:i?"loading":"hide"}),u.default.createElement(d.Button,{disabled:i||l||n.value==a.value,type:"submit"},"确定"),u.default.createElement(d.Button,{bsStyle:"link",disabled:i,onClick:this.handleCancel},"取消"))))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,versions:s.PropTypes.array.isRequired,submitting:s.PropTypes.bool,invalid:s.PropTypes.bool,values:s.PropTypes.object,fields:s.PropTypes.object,handleSubmit:s.PropTypes.func.isRequired,merge:s.PropTypes.func.isRequired,close:s.PropTypes.func.isRequired},enumerable:!0}]);var r=t;return t=(0,c.reduxForm)({form:"mergeversion",fields:["source","dest"],validate:b})(t)||t}(s.Component);t.default=g,e.exports=t.default}).call(this)}finally{}},2034:function(e,t,r){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r){for(var n=!0;n;){var a=e,o=t,l=r;n=!1,null===a&&(a=Function.prototype);var i=Object.getOwnPropertyDescriptor(a,o);if(void 0!==i){if("value"in i)return i.value;var s=i.get;if(void 0===s)return;return s.call(l)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=o,r=l,n=!0,i=u=void 0}},s=r(1),u=n(s),c=r(2),d=r(7),p=n(d),f=r(5),m=r(3),h=n(m),y=r(4),v=function(e){function t(e){a(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={ecode:0,operate_flg:"0",swapVersion:"",isSendMsg:!0},this.confirm=this.confirm.bind(this),this.cancel=this.cancel.bind(this)}return o(t,e),l(t,[{key:"confirm",value:function(){var e,t,r,n,a;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.close,r=e.release,n=e.data,o.next=6,regeneratorRuntime.awrap(r(h.default.extend({},{id:n.id},{status:"released"===n.status?"unreleased":"released",operate_flg:this.state.operate_flg,swap_version:this.state.swapVersion,isSendMsg:this.state.isSendMsg})));case 6:a=o.sent,0===a&&(t(),"released"===n.status?f.notify.show("发布完成。","success",2e3):f.notify.show("已置完成。","success",2e3)),this.setState({ecode:a});case 9:case"end":return o.stop()}},null,this)}},{key:"cancel",value:function(){var e=this.props,t=e.close,r=e.loading;r||t()}},{key:"render",value:function(){var e=this,t=this.props,r=t.i18n.errMsg,n=t.data,a=t.versions,o=t.loading;return u.default.createElement(c.Modal,{show:!0,onHide:this.cancel,backdrop:"static","aria-labelledby":"contained-modal-title-sm"},u.default.createElement(c.Modal.Header,{closeButton:!0},u.default.createElement(c.Modal.Title,{id:"contained-modal-title-la"},"版本","released"===n.status?"取消发布":"发布"," - ",n.name)),"released"!==n.status&&u.default.createElement(c.Modal.Body,null,n.unresolved_cnt>0?u.default.createElement("div",{className:"info-col",style:{marginTop:"5px"}},u.default.createElement("div",{className:"info-icon"},u.default.createElement("i",{className:"fa fa-info-circle"})),u.default.createElement("div",{className:"info-content"},"该版本还有 ",u.default.createElement("span",{style:{color:"red",fontWeight:600}},n.unresolved_cnt)," 个问题未解决。")):u.default.createElement("div",{className:"info-col",style:{marginTop:"5px"}},u.default.createElement("div",{className:"info-icon"},u.default.createElement("i",{className:"fa fa-info-circle"})),u.default.createElement("div",{className:"info-content"},"该版本没有未解决的问题。")),n.unresolved_cnt>0&&u.default.createElement("div",{style:{margin:"20px 10px 10px 10px"}},u.default.createElement("div",{style:{display:"inline-block",verticalAlign:"top",fontWeight:600}},"未解决的问题"),u.default.createElement("div",{style:{display:"inline-block",marginLeft:"20px"}},u.default.createElement(c.FormGroup,null,u.default.createElement(c.Radio,{inline:!0,name:"swap",onClick:function(){e.setState({operate_flg:"1"})},checked:"1"===this.state.operate_flg},"移动至版本"),u.default.createElement("div",{style:{width:"300px",margin:"5px 5px 10px 18px"}},u.default.createElement(p.default,{simpleValue:!0,clearable:!1,disabled:"1"!==this.state.operate_flg,options:h.default.map(h.default.reject(a,{id:n.id}),function(e){return{value:e.id,label:e.name}}),value:this.state.swapVersion,onChange:function(t){e.setState({swapVersion:t})},placeholder:"选择版本"})),u.default.createElement(c.Radio,{inline:!0,name:"ignore",onClick:function(){e.setState({operate_flg:"2"})},checked:"2"===this.state.operate_flg},"忽略继续发布"))))),"released"===n.status&&u.default.createElement(c.Modal.Body,null,"该版本确认要取消发布吗？"),u.default.createElement(c.Modal.Footer,null,u.default.createElement("span",{className:"ralign"},0!==this.state.ecode&&!o&&r[this.state.ecode]),u.default.createElement("img",{src:y,className:o?"loading":"hide"}),"released"!==n.status&&u.default.createElement(c.Checkbox,{disabled:o,checked:this.state.isSendMsg,onClick:function(){e.setState({isSendMsg:!e.state.isSendMsg})},style:{display:"inline-block",marginRight:"20px",marginLeft:"10px"}},"通知项目成员"),u.default.createElement(c.Button,{onClick:this.confirm,disabled:o||"released"!==n.status&&n.unresolved_cnt>0&&"0"===this.state.operate_flg||"released"!==n.status&&"1"===this.state.operate_flg&&!this.state.swapVersion},"确定"),u.default.createElement(c.Button,{bsStyle:"link",disabled:o,onClick:this.cancel},"取消")))}}],[{key:"propTypes",value:{i18n:s.PropTypes.object.isRequired,close:s.PropTypes.func.isRequired,release:s.PropTypes.func.isRequired,versions:s.PropTypes.array.isRequired,loading:s.PropTypes.bool.isRequired,data:s.PropTypes.object.isRequired},enumerable:!0}]),t}(s.Component);t.default=v,e.exports=t.default}).call(this)}finally{}},2095:function(e,t,r){try{(function(){"use strict";function e(e,t){return(0,u.asyncFuncCreator)({constant:"VERSION_INDEX",promise:function(r){return r.request({url:"/project/"+e+"/version"+(t?"?"+t:"")})}})}function n(e,t){return(0,u.asyncFuncCreator)({constant:"VERSION_CREATE",promise:function(r){return r.request({url:"/project/"+e+"/version",method:"post",data:t})}})}function a(e,t){return(0,u.asyncFuncCreator)({constant:"VERSION_UPDATE",promise:function(r){return r.request({url:"/project/"+e+"/version/"+t.id,method:"put",data:t})}})}function o(e,t){return(0,u.asyncFuncCreator)({constant:"VERSION_RELEASE",promise:function(r){return r.request({url:"/project/"+e+"/version/"+t.id+"/release",method:"post",data:t})}})}function l(e,t){return(0,u.asyncFuncCreator)({constant:"VERSION_MERGE",source:t.source||"",dest:t.dest||"",promise:function(r){return r.request({url:"/project/"+e+"/version/merge",data:t,method:"post"})}})}function i(e){return{type:"VERSION_SELECT",id:e}}function s(e,t){return(0,u.asyncFuncCreator)({constant:"VERSION_DELETE",id:t.id,promise:function(r){return r.request({url:"/project/"+e+"/version/"+t.id+"/delete",data:t,method:"post"})}})}Object.defineProperty(t,"__esModule",{value:!0}),t.index=e,t.create=n,t.update=a,t.release=o,t.merge=l,t.select=i,t.del=s;var u=r(27)}).call(this)}finally{}}});
//# sourceMappingURL=version-78d786ab55e573352ea9.js.map